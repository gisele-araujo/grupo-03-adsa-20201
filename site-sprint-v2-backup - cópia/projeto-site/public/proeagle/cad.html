<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Pro Eagle</title>
    
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="bootstrap/node_modules/bootstrap/compiler/bootstrap.css">
    <link rel="stylesheet" href="bootstrap/node_modules/bootstrap/compiler/style.css">

</head>
<body class="body">

    <nav class="navbar navbar-expand-lg navbar-dark">

        <div class="container">
            <a class="nav-link" href="index.html"><img src="img/left-arrow.png" alt="" style="width: 30px;"></a>
            <a class="navbar-brand h1 mb-0" href="#">Pro Eagle</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item">
                        <button type="button" class="btn" data-toggle="modal" data-target="#exampleModal">
                            Entrar
                        </button>
                    </li>
                    <li class="nav-item ">
                        <button type="button" class="btn btn-primary" onclick="cadastro()">
                            Cadastre-se
                        </button>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    
<div class="containercad">
    <div class="row">
        <div class="col-lg-12">
            <h2>Cadastro ProEagle</h2>
           
            <form form id="form_cadastro" method="post" onsubmit="return cadastrar()">
                <div id="step_1" class="step">
                        <div class="form-group">
                            <h5 class="py-3"><p class="text-primary">Etapa 1/3</p> Informações Pessoais</h5>
                            <label >Nome:</label>
                            <input type="text" name="nomeCompleto" id="validaNome" class="form-control">
                        </div>
                        
                        <!-- <div class="form-group">
                            <label >Cargo:</label>
                            <input type="text" name="cargo" id="cargo" class="form-control">
                        </div> -->
                </div>                
                <div id="step_2" class="step">
                    <div class="form-group">
                        <h5 class="py-3"><p class="text-primary">Etapa 2/3</p> Contato</h5>
                        <label >Email:</label>
                        <input type="email" name="email" id="validaEmail" class="form-control">
                    </div>
                        <div class="form-group">
                            <label >Telefone:</label>
                            <input type="tel" name="telefoneCelular" id="fone" class="form-control">
                        </div>
                </div>                
                <div id="step_3" class="step">
                    <div class="form-group">
                        <h5 class="py-3"><p class="text-primary">Etapa 3/3</p> Foto e Senha</h5>
                        <label >Foto de perfil:</label>
                        <input type="url" name="fotoPerfil" id="end" class="form-control">
                    </div>
                        <div class="form-group">
                            <label >Senha:</label>
                            <input type="password" name="senha" id="validaSenha" class="form-control">
                        </div>
                        <!-- <div class="form-group">
                            <label >Repita a senha:</label>
                            <input type="password" name="senha" id="confirmaSenha" class="form-control">
                        </div> -->
                        <div class="form-group">
                            <button type="submit" id="btn_entrar" class="btn btn-block btn-primary">Enviar</button>
                        </div>
                </div>
                <img src="" id="img_aguarde">
                <div id="div_erro"></div>

            </form>             
        </div>
    </div>    
    <div class="row">
            <div class="col-lg-6">
                    <button class="btn btn-block btn-outline-light my-2" id="prev" >Anterior</button>
            </div>
            <div class="col-lg-6">
                    <button class="btn btn-block btn-primary my-2" id="next" >Próximo</button>
            </div>
    </div>
</div>


<!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <!-- <script src="../site-institucional/Beck/src/validacao.js"></script> -->
    <script src="bootstrap/node_modules/jquery/dist/jquery.js"></script>
    <script src="bootstrap/node_modules/popper.js/dist/popper.js"></script>
    <script src="bootstrap/node_modules/bootstrap/dist/js/bootstrap.js"></script>
    <script>
 $(document).ready(function(){

    //Esconde todos os passos e exibe o primeiro ao carregar a página 
    $('.step').hide();
    $('.step').first().show();

    //Exibe no topo em qual passo estamos pela ordem da div que esta visivel
    var passoexibido = function(){
        var index = parseInt($(".step:visible").index());
        if(index == 0){
            //Se for o primeiro passo desabilita o botão de voltar
            $("#prev").prop('disabled',true);
        }else if(index == (parseInt($(".step").length)-1)){
            //Se for o ultimo passo desabilita o botão de avançar
            $("#next").prop('disabled',true);
        }else{
            //Em outras situações os dois serão habilitados
            $("#next").prop('disabled',false);            
            $("#prev").prop('disabled',false);
        }
        $("#passo").html(index + 1);

    };
    
    //Executa a função ao carregar a página
    passoexibido();

    //avança para o próximo passo
    $("#next").click(function(){
        $(".step:visible").hide().next().show();
        passoexibido();
    });

    //retrocede para o passo anterior
    $("#prev").click(function(){
        $(".step:visible").hide().prev().show();
        passoexibido();
    });

 });
</script>

<!-- Cadastro function -->
<script>
    function cadastrar() {
        aguardar();
        var formulario = new URLSearchParams(new FormData(form_cadastro));
        fetch("/usuarios/cadastrar", {
            method: "POST",
            body: formulario
        }).then(function (response) {
            
            if (response.ok) {

                window.location.href='index-proeagle.html';

            } else {

                console.log('Erro de cadastro!');
                response.text().then(function (resposta) {
                    div_erro.innerHTML = resposta;
                });
                finalizar_aguardar();
            }
        });

        return false;
    }

    function aguardar() {
        btn_entrar.disabled = true;
        img_aguarde.style.display='block';
        div_erro.style.display='none';
    }

    function finalizar_aguardar() {
        btn_entrar.disabled = false;
        img_aguarde.style.display='none';
        div_erro.style.display='block';
    }
</script>
</body>
</html>